mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
warnings()
library(RColorBrewer)
# Classic palette BuPu, with 4 colors
coul = brewer.pal(4, "BuPu")
# I can add more tones to this palette :
coul = colorRampPalette(coul)(25)
# Plot it
pie(rep(1, length(coul)), col = coul , main="")
library(RColorBrewer)
# Classic palette BuPu, with 4 colors
coul = brewer.pal(11, "Paired")
# I can add more tones to this palette :
coul = colorRampPalette(coul)(20)
# Plot it
pie(rep(1, length(coul)), col = coul , main="")
coul = brewer.pal(4, "Paired")
coul = colorRampPalette(coul)(19)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
warnings()
coul
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul(19),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul(1:19),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=colorRampPalette(coul)(19),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=colorRampPalette(coul)(19),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
coul
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
warnings()
coul = brewer.pal(4, "Paired")
coul = colorRampPalette(coul)(19)
length(coul)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. parvum '),"genotypes")),
cex=3)
legend(-180.1516,90,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
legend(-180.1516,90,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul,#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
pie(rep(1, length(coul)), col = coul , main="")
coul = brewer.pal(10, "Paired")
coul = colorRampPalette(coul)(19)
pie(rep(1, length(coul)), col = coul , main="")
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#brewer.pal(12,'Paired'),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. parvum '),"genotypes")),
cex=3)
legend(-180.1516,90,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul,#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
legend(-180.1516,95,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul,#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
source('~/GitHub/protozoa_map/haplotype_map_code.R', echo=TRUE)
source('~/GitHub/protozoa_map/psi_code.R', echo=TRUE)
rm(list=ls())
require(doBy)
require(plyr)
require(rworldmap)
require(countrycode)
library(RColorBrewer)
data_giardia<-read.csv("giardia_world_nz_1.csv", header = T)
rm(list=ls())
require(doBy)
require(plyr)
require(rworldmap)
require(countrycode)
library(RColorBrewer)
data_giardia<-read.csv("giardia_world_nz_1.csv", header = T)
data_giardia<-read.csv("giardia_world_nz_2.csv", header = T)
colnames(data_giardia)[1]<-'Country'
dF <- getMap()@data
iso<-countrycode(data_giardia$Country,"country.name","iso3c")
data_giardia$iso<-iso
malMap <- joinCountryData2Map(data_giardia, joinCode = "ISO3",
nameJoinColumn = "iso")
dF <- malMap@data
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
pdf("giardia_assemblages.pdf", width=8, height=6)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c("A",
"B",
"C",
"D",
"E",
"F",
"G",
"H"),#,
zColours=brewer.pal(8,'Paired'),#c(1:8),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('Giardia '),"assemblages")),
cex=3)
legend(-180.1516,90,
legend=c("A",
"B",
"C",
"D",
"E",
"F",
"G",
"H"),
col=brewer.pal(8,'Paired'),#c(1:8),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
dev.off()
dev.off()
data_hominis<-read.csv("chominis_world_nz_1.csv", header = T)
dF <- getMap()@data
data_hominis<-read.csv("chominis_world_nz_2.csv", header = T)
dF <- getMap()@data
iso<-countrycode(data_hominis$Country,"country.name","iso3c")
data_hominis$iso<-iso
malMap <- joinCountryData2Map(data_hominis, joinCode = "ISO3",
nameJoinColumn = "iso")
dF <- malMap@data
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
pdf("hominis_assemblages.pdf", width=8, height=6)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('Ia','Ib','Id','Ie', 'If', 'Ig' ,'Ii', 'Ij','Ik'),#
zColours=brewer.pal(9,'Paired'),#c(1:9),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. hominis '),"genotypes")),
cex=3)
legend(-180.1516,90,
legend=c('Ia','Ib','Id','Ie', 'If', 'Ig' ,'Ii', 'Ij','Ik'),
col=brewer.pal(9,'Paired'),#c(1:9),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
dev.off()
data_parvum<-read.csv("cparvum_world_nz_1.csv", header = T)
data_parvum<-read.csv("cparvum_world_nz_2.csv", header = T)
dF <- getMap()@data
iso<-countrycode(data_parvum$Country,"country.name","iso3c")
data_parvum$iso<-iso
malMap <- joinCountryData2Map(data_parvum, joinCode = "ISO3",
nameJoinColumn = "iso")
dF <- malMap@data
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
coul = brewer.pal(10, "Paired")
coul = colorRampPalette(coul)(19)
pdf("parvum_assemblages.pdf", width=8, height=6)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#brewer.pal(12,'Paired'),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. parvum '),"genotypes")),
cex=3)
legend(-180.1516,95,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul,#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
dev.off()
library(spaa)
library(ggplot2)
library(reshape2)
datG<-read.csv('giardia_world_nz_1.csv',header=T)
datcp<-read.csv('cparvum_world_nz_1.csv',header=T)
datch<-read.csv('chominis_world_nz_1.csv',header=T)
datG<-read.csv('giardia_world_nz_2.csv',header=T)
datcp<-read.csv('cparvum_world_nz_2.csv',header=T)
datch<-read.csv('chominis_world_nz_2.csv',header=T)
datcp<- subset(datcp, rowSums(datcp[,2:16]) > 10)
rescp<-niche.overlap(t(datcp[,2:16]),method='schoener')
rscp<-as.matrix(rescp)
rownames(rscp)<-datcp$Country
colnames(rscp)<-datcp$Country
datch<- subset(datch, rowSums(datch[,2:11]) > 10)
resch<-niche.overlap(t(datch[,2:11]),method='schoener')
rsch<-as.matrix(resch)
rownames(rsch)<-datch$Country
colnames(rsch)<-datch$Country
datG<- subset(datG, rowSums(datG[,2:9]) > 10)
resg<-niche.overlap(t(datG[,2:9]),method='schoener')
rsg<-as.matrix(resg)
rownames(rsg)<-datG$Country
colnames(rsg)<-datG$Country
get_lower_tri<-function(cormat){
cormat[upper.tri(cormat)] <- NA
return(cormat)
}
get_upper_tri <- function(cormat){
cormat[lower.tri(cormat)]<- NA
return(cormat)
}
reorder_cormat <- function(cormat){
# Use correlation between variables as distance
dd <- as.dist((1-cormat)/2)
hc <- hclust(dd)
cormat <-cormat[hc$order, hc$order]
}
rsg<-reorder_cormat(rsg)
rsg_r<-get_upper_tri(rsg)
prsg<-melt(rsg_r,na.rm=T)
prsg$value <- ifelse(prsg$Var1 == prsg$Var2, 1, prsg$value)
pdf("giardia_psi.pdf",height=8,width = 8)
ggplot(data = prsg, aes(Var2, Var1, fill = value))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", mid = "yellow",
midpoint = 0.5, limit = c(0,1), space = "Lab",
name="") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
#size = 10,
hjust = 1),
plot.title = element_text(size=14, face="bold.italic"))+
coord_fixed()+labs(x="",y="",title="Giardia")
dev.off()
rscp<-reorder_cormat(rscp)
rscp_r<-get_upper_tri(rscp)
prscp<-melt(rscp_r,na.rm=T)
prscp$value <- ifelse(prscp$Var1 == prscp$Var2, 1, prscp$value)
pdf('c_parvum_psi.pdf',height=8,width = 8)
ggplot(data = prscp, aes(Var2, Var1, fill = value))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", mid = "yellow",
midpoint = 0.5, limit = c(0,1), space = "Lab",
name="") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
#size = 10,
hjust = 1),
plot.title = element_text(size=14, face="bold.italic"))+
coord_fixed()+labs(x="",y="",title="Cryptosporidium parvum")
dev.off()
rsch<-reorder_cormat(rsch)
rsch_r<-get_upper_tri(rsch)
prsch<-melt(rsch_r,na.rm=T)
prsch$value <- ifelse(prsch$Var1 == prsch$Var2, 1, prsch$value)
pdf('c_hominis_psi.pdf',height=8,width = 8)
ggplot(data = prsch, aes(Var2, Var1, fill = value))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "white", high = "red", mid = "yellow",
midpoint = 0.5, limit = c(0,1), space = "Lab",
name="") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
#size = 10,
hjust = 1),
plot.title = element_text(size=14, face="bold.italic"))+
coord_fixed()+labs(x="",y="",title="Cryptosporidium hominis")
dev.off()
rescp.bt<-niche.overlap.boot(t(datcp[,2:16]),method='schoener')
resch.bt<-niche.overlap.boot(t(datch[,2:11]),method='schoener')
resG.bt<-niche.overlap.boot(t(datG[,2:9]),method='schoener')
colnames(prsch)[3]<-'Observed'
prsch$Observed<-round(prsch$Observed,3)
tp<-expand.grid(datch$Country,datch$Country)
tp1<-expand.grid(rownames(datch),rownames(datch))
dattp<-data.frame(tp,tp1)
dattp$rn = paste(dattp$Var1.1, dattp$Var2.1, sep="-")
resch.bt<-as.data.frame(resch.bt)
resch.bt$rn<-rownames(resch.bt)
merge_tp<-merge(resch.bt,dattp,by="rn")
names(merge_tp) <- sub(" ", ".", names(merge_tp))
merge_total<-merge_tp
merge_total<-merge_total[with(merge_total, order(-Observed)), ]
pdf('c_hominis_psi_boot_fig.pdf',height=8,width = 8)
ggplot(data = merge_total, aes(Var2, Var1, fill = Observed))+
geom_tile(color = "white")+
# geom_text(aes(fill = merge_total$Observed, label = round(merge_total$Observed, 1))) +
geom_text(aes(fill = merge_total$Boot.CI1, label = round(merge_total$Boot.CI1, 1),vjust=-0.6),size=2) +
geom_text(aes(fill = merge_total$Boot.CI2, label = round(merge_total$Boot.CI2, 1),vjust=0.8),size=2) +
scale_fill_gradient2(low = "white", high = "red", mid = "yellow",
midpoint = 0.5, limit = c(0,1), space = "Lab",
name="") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 10, hjust = 1),
plot.title = element_text(size=14, face="bold.italic"))+
coord_fixed()+labs(x="",y="",title="Cryptosporidium hominis")
dev.off()
colnames(prscp)[3]<-'Observed'
prscp$Observed<-round(prscp$Observed,3)
tp<-expand.grid(datcp$Country,datcp$Country)
tp1<-expand.grid(rownames(datcp),rownames(datcp))
dattp<-data.frame(tp,tp1)
dattp$rn = paste(dattp$Var1.1, dattp$Var2.1, sep="-")
rescp.bt<-as.data.frame(rescp.bt)
rescp.bt$rn<-rownames(rescp.bt)
merge_tp<-merge(rescp.bt,dattp,by="rn")
names(merge_tp) <- sub(" ", ".", names(merge_tp))
merge_total<-merge_tp
merge_total<-merge_total[with(merge_total, order(-Observed)), ]
pdf('c_parvum_psi_boot_fig.pdf',height=8,width = 8)
ggplot(data = merge_total, aes(Var2, Var1, fill = Observed))+
geom_tile(color = "white")+
# geom_text(aes(fill = merge_total$Observed, label = round(merge_total$Observed, 1))) +
geom_text(aes(fill = merge_total$Boot.CI1, label = round(merge_total$Boot.CI1, 1),vjust=-0.6),size=2) +
geom_text(aes(fill = merge_total$Boot.CI2, label = round(merge_total$Boot.CI2, 1),vjust=0.8),size=2) +
scale_fill_gradient2(low = "white", high = "red", mid = "yellow",
midpoint = 0.5, limit = c(0,1), space = "Lab",
name="") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 10, hjust = 1),
plot.title = element_text(size=14, face="bold.italic"))+
coord_fixed()+labs(x="",y="",title="Cryptosporidium parvum")
dev.off()
colnames(prsg)[3]<-'Observed'
prsg$Observed<-round(prsg$Observed,3)
tp<-expand.grid(datG$Country,datG$Country)
tp1<-expand.grid(rownames(datG),rownames(datG))
dattp<-data.frame(tp,tp1)
dattp$rn = paste(dattp$Var1.1, dattp$Var2.1, sep="-")
resg.bt<-as.data.frame(resG.bt)
resg.bt$rn<-rownames(resg.bt)
merge_tp<-merge(resg.bt,dattp,by="rn")
names(merge_tp) <- sub(" ", ".", names(merge_tp))
merge_total<-merge_tp
merge_total<-merge_total[with(merge_total, order(-Observed)), ]
pdf('giardia_psi_boot_fig.pdf',height=8,width = 8)
ggplot(data = merge_total, aes(Var2, Var1, fill = Observed))+
geom_tile(color = "white")+
# geom_text(aes(fill = merge_total$Observed, label = round(merge_total$Observed, 1))) +
geom_text(aes(fill = merge_total$Boot.CI1, label = round(merge_total$Boot.CI1, 1),vjust=-0.6),size=2) +
geom_text(aes(fill = merge_total$Boot.CI2, label = round(merge_total$Boot.CI2, 1),vjust=0.8),size=2) +
scale_fill_gradient2(low = "white", high = "red", mid = "yellow",
midpoint = 0.5, limit = c(0,1), space = "Lab",
name="") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 10, hjust = 1),
plot.title = element_text(size=14, face="bold.italic"))+
coord_fixed()+labs(x="",y="",title="Giardia")
dev.off()
