out
}
iters<-2000
datG<-read.csv('giardia.csv',header=T)
datcp<-read.csv('cparvum.csv',header=T)
datch<-read.csv('chominis.csv',header=T)
getwd()
setwd('D:/Dropbox/protozoa_rarefraction')
datG<-read.csv('giardia.csv',header=T)
datcp<-read.csv('cparvum.csv',header=T)
datch<-read.csv('chominis.csv',header=T)
d<-  datG### Choose
sources<-dim(d)[1]   # change for # countries
d<-scan('giardia.csv')  #NonTyphimuriumPSI, TyphimuriumPSI, AllSalmonellaPSI
library(vegan)
datG<-read.csv('giardia.csv',header=T)
datcp<-read.csv('cparvum.csv',header=T)
datch<-read.csv('chominis.csv',header=T)
par(mfrow=c(1,3))
datcp.r<-(datcp[!datcp$Country=='New Zealand',])
datcp.sc<-specaccum(datcp.r[,2:16],'random')
plot(datcp.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium parvum')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=4,cex=2,pch=16,col='red')
datcp<- subset(datcp, rowSums(datcp[,2:16]) > 10)
datG
rm(list=ls())
library(vegan)
datG<-read.csv('giardia.csv',header=T)
datG<-read.csv('giardia_world_nz_1.csv',header=T)
par(mfrow=c(1,3))
datcp.r<-(datcp[!datcp$Country=='New Zealand',])
datcp<-read.csv('cparvum.csv',header=T)
datch<-read.csv('chominis.csv',header=T)
par(mfrow=c(1,3))
datcp.r<-(datcp[!datcp$Country=='New Zealand',])
datG<-read.csv('giardia_world_nz_1.csv',header=T)
datcp<-read.csv('cparvum_world_nz_1.csv',header=T)
datch<-read.csv('chominis_world_nz_1.csv',header=T)
par(mfrow=c(1,3))
datcp.r<-(datcp[!datcp$Country=='New Zealand',])
datcp.sc<-specaccum(datcp.r[,2:16],'random')
plot(datcp.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium parvum')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=4,cex=2,pch=16,col='red')
datcp<- subset(datcp, rowSums(datcp[,2:16]) > 10)
H <- diversity(datcp[,2:16])
simp <- diversity(datcp[,2:16], "simpson")
invsimp <- diversity(datcp[,2:16], "inv")
r.2 <- rarefy(datcp[,2:16], 1)
alpha <- fisher.alpha(datcp[,2:16])
S <- specnumber(datcp[,2:16]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datcp[,2:16])
summary(pool, display = "chao")
estimateR(datcp[,2:16])
datch.sc<-specaccum(datch[,2:11],'random')
plot(datch.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium hominis')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
datch<- subset(datch, rowSums(datch[,2:11]) > 10)
H <- diversity(datch[,2:11])
simp <- diversity(datch[,2:11], "simpson")
invsimp <- diversity(datch[,2:11], "inv")
r.2 <- rarefy(datch[,2:11], 1)
alpha <- fisher.alpha(datch[,2:11])
S <- specnumber(datch[,2:11]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datch[,2:11])
summary(pool, display = "chao")
estimateR(datch[,2:11])
datG.sc<-specaccum(datG[,2:9],'random')
plot(datG.sc,ci.type="poly", col="darkgreen", lwd=2, ci.lty=0, ci.col="lightgreen", main = expression(italic(Giardia)),
xlab='Countries',ylab='Assemblages',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
datG<- subset(datG, rowSums(datG[,2:9]) > 10)
H <- diversity(datG[,2:9])
simp <- diversity(datG[,2:9], "simpson")
invsimp <- diversity(datG[,2:9], "inv")
r.2 <- rarefy(datG[,2:9], 1)
alpha <- fisher.alpha(datG[,2:9])
S <- specnumber(datG[,2:9]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datG[,2:9])
summary(pool, display = "chao")
estimateR(datG[,2:9])
datch.sc
dim(datch.sc)
datch
datG<-read.csv('giardia_world_nz_1.csv',header=T)
datcp<-read.csv('cparvum_world_nz_1.csv',header=T)
datch<-read.csv('chominis_world_nz_1.csv',header=T)
par(mfrow=c(1,3))
datcp.r<-(datcp[!datcp$Country=='New Zealand',])
datcp.r
dim(datcp.r)
datcp.sc<-specaccum(datcp.r[,2:17],'random')
plot(datcp.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium parvum')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=4,cex=2,pch=16,col='red')
datcp.sc<-specaccum(datcp.r[,2:17],'random')
plot(datcp.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium parvum')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,47))
points(x=1,y=4,cex=2,pch=16,col='red')
datcp<- subset(datcp, rowSums(datcp[,2:17]) > 10)
H <- diversity(datcp[,2:16])
simp <- diversity(datcp[,2:16], "simpson")
invsimp <- diversity(datcp[,2:16], "inv")
r.2 <- rarefy(datcp[,2:16], 1)
alpha <- fisher.alpha(datcp[,2:16])
S <- specnumber(datcp[,2:16]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datcp[,2:16])
summary(pool, display = "chao")
estimateR(datcp[,2:16])
datch.sc<-specaccum(datch[,2:11],'random')
dim(datcp)
dim(datch)
datcp<- subset(datcp, rowSums(datcp[,2:17]) > 10)
H <- diversity(datcp[,2:17])
simp <- diversity(datcp[,2:17], "simpson")
invsimp <- diversity(datcp[,2:17], "inv")
r.2 <- rarefy(datcp[,2:17], 1)
alpha <- fisher.alpha(datcp[,2:17])
# pairs(cbind(H, simp, invsimp, r.2, alpha), pch="+", col="blue")
## Species richness (S) and Pielou's evenness (J):
S <- specnumber(datcp[,2:17]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datcp[,2:17])
summary(pool, display = "chao")
# plot(pool)
## Quantitative model
estimateR(datcp[,2:17])
datcp.sc<-specaccum(datcp.r[,2:17],'random')
plot(datcp.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium parvum')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,47))
points(x=1,y=4,cex=2,pch=16,col='red')
datcp<- subset(datcp, rowSums(datcp[,2:17]) > 10)
datcp.r<-(datcp[!datcp$Country=='New Zealand',])
datcp.sc<-specaccum(datcp.r[,2:17],'random')
plot(datcp.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium parvum')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,47))
points(x=1,y=4,cex=2,pch=16,col='red')
H <- diversity(datcp[,2:17])
simp <- diversity(datcp[,2:17], "simpson")
invsimp <- diversity(datcp[,2:17], "inv")
r.2 <- rarefy(datcp[,2:17], 1)
alpha <- fisher.alpha(datcp[,2:17])
S <- specnumber(datcp[,2:17]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datcp[,2:17])
summary(pool, display = "chao")
estimateR(datcp[,2:17])
datch.sc<-specaccum(datch[,2:11],'random')
plot(datch.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium hominis')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
datch<- subset(datch, rowSums(datch[,2:11]) > 10)
datch.sc<-specaccum(datch[,2:11],'random')
plot(datch.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium hominis')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
dim(datch)
datch.sc<-specaccum(datch[,2:11],'random')
plot(datch.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium hominis')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
datch[,2:11]
datch.sc<-specaccum(datch[,2:11],'random')
plot(datch.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium hominis')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
datch.sc
datcp.sc
datG[,2:9]
datG
dim(datG)
rm(list=ls())
library(vegan)
datG<-read.csv('giardia_world_nz_1.csv',header=T)
datcp<-read.csv('cparvum_world_nz_1.csv',header=T)
datch<-read.csv('chominis_world_nz_1.csv',header=T)
par(mfrow=c(1,3))
datcp.r<-(datcp[!datcp$Country=='New Zealand',])
datcp.sc<-specaccum(datcp.r[,2:17],'random')
plot(datcp.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium parvum')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,47))
points(x=1,y=4,cex=2,pch=16,col='red')
datcp<- subset(datcp, rowSums(datcp[,2:17]) > 10)
H <- diversity(datcp[,2:17])
simp <- diversity(datcp[,2:17], "simpson")
invsimp <- diversity(datcp[,2:17], "inv")
r.2 <- rarefy(datcp[,2:17], 1)
alpha <- fisher.alpha(datcp[,2:17])
S <- specnumber(datcp[,2:17]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datcp[,2:17])
summary(pool, display = "chao")
estimateR(datcp[,2:17])
datch.sc<-specaccum(datch[,2:11],'random')
plot(datch.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium hominis')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
datch<- subset(datch, rowSums(datch[,2:11]) > 10)
H <- diversity(datch[,2:11])
simp <- diversity(datch[,2:11], "simpson")
invsimp <- diversity(datch[,2:11], "inv")
r.2 <- rarefy(datch[,2:11], 1)
alpha <- fisher.alpha(datch[,2:11])
S <- specnumber(datch[,2:11]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datch[,2:11])
summary(pool, display = "chao")
estimateR(datch[,2:11])
datG.sc<-specaccum(datG[,2:9],'random')
plot(datG.sc,ci.type="poly", col="darkgreen", lwd=2, ci.lty=0, ci.col="lightgreen", main = expression(italic(Giardia)),
xlab='Countries',ylab='Assemblages',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
dim(datG)
datG.sc<-specaccum(datG[,2:9],'random')
plot(datG.sc,ci.type="poly", col="darkgreen", lwd=2, ci.lty=0, ci.col="lightgreen", main = expression(italic(Giardia)),
xlab='Countries',ylab='Assemblages',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
datG<- subset(datG, rowSums(datG[,2:9]) > 10)
H <- diversity(datG[,2:9])
simp <- diversity(datG[,2:9], "simpson")
invsimp <- diversity(datG[,2:9], "inv")
r.2 <- rarefy(datG[,2:9], 1)
alpha <- fisher.alpha(datG[,2:9])
S <- specnumber(datG[,2:9]) ## rowSums(BCI > 0) does the same...
J <- H/log(S)
pool <- poolaccum(datG[,2:9])
summary(pool, display = "chao")
estimateR(datG[,2:9])
dev.off()
par(mfrow=c(1,3))
dat_pred_cp<-fitspecaccum(datcp.sc, "arrh")
matplot(predict(dat_pred_cp,newdata = 1:200),type='l',lty=1,col='grey',ylim=c(0,80),
xlab='Countries',ylab="Genotypes",main = expression(italic('Cryptosporidium parvum')))
lines(rowMeans(predict(dat_pred_cp,newdata = 1:200)),lwd=2)
lines(rowMeans(predict(dat_pred_cp,newdata = 1:200))+apply(predict(dat_pred_cp,newdata = 1:200),1,sd),lty=2)
lines(rowMeans(predict(dat_pred_cp,newdata = 1:200))-apply(predict(dat_pred_cp,newdata = 1:200),1,sd),lty=2)
dat_pred_ch<-fitspecaccum(datch.sc, "arrh")
matplot(predict(dat_pred_ch,newdata = 1:200),type='l',lty = 1,col='grey',ylim=c(0,80),
xlab='Countries',ylab="Genotypes",main = expression(italic('Cryptosporidium hominis')))
lines(rowMeans(predict(dat_pred_ch,newdata = 1:200)),lwd=2)
lines(rowMeans(predict(dat_pred_ch,newdata = 1:200))+apply(predict(dat_pred_cp,newdata = 1:200),1,sd),lty=2)
lines(rowMeans(predict(dat_pred_ch,newdata = 1:200))-apply(predict(dat_pred_cp,newdata = 1:200),1,sd),lty=2)
dat_pred_g<-fitspecaccum(datG.sc, "arrh")
matplot(predict(dat_pred_g,newdata = 1:200),type='l',lty=1,col='grey',ylim=c(0,80),
xlab='Countries',ylab="Assemblages",main = expression(italic('Giardia')))
lines(rowMeans(predict(dat_pred_g,newdata = 1:200)),lwd=2)
lines(rowMeans(predict(dat_pred_g,newdata = 1:200))+apply(predict(dat_pred_cp,newdata = 1:200),1,sd),lty=2)
lines(rowMeans(predict(dat_pred_g,newdata = 1:200))-apply(predict(dat_pred_cp,newdata = 1:200),1,sd),lty=2)
dev.off()
datG.sc<-specaccum(datG[,2:9],'random')
plot(datG.sc,ci.type="poly", col="darkgreen", lwd=2, ci.lty=0, ci.col="lightgreen", main = expression(italic(Giardia)),
xlab='Countries',ylab='Assemblages',ylim=c(0,18),xlim=c(0,45))
points(x=1,y=6,cex=2,pch=16,col='red')
source('~/GitHub/protozoa_map/rarefaction.R', echo=TRUE)
source('~/GitHub/protozoa_map/rarefaction.R', echo=TRUE)
pdf('species_accumulation_10.pdf',width=10,height=5)
par(mfrow=c(1,3))
## C. parvum
datcp.r<-(datcp[!datcp$Country=='New Zealand',])
datcp<- subset(datcp, rowSums(datcp[,2:17]) > 10)
datcp.sc<-specaccum(datcp.r[,2:17],'random')
plot(datcp.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium parvum')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,50))
points(x=1,y=4,cex=2,pch=16,col='red')
# points(y=sum(datcp[datcp$Country=='New Zealand',2:16]>0),x=1,pch=16,col='red')
## C. hominis
datch<- subset(datch, rowSums(datch[,2:11]) > 10)
datch.sc<-specaccum(datch[,2:11],'random')
plot(datch.sc,ci.type="poly", col="blue", lwd=2, ci.lty=0, ci.col="lightblue", main = expression(italic('Cryptosporidium hominis')),
xlab='Countries',ylab='Genotypes',ylim=c(0,18),xlim=c(0,50))
points(x=1,y=6,cex=2,pch=16,col='red')
# points(y=sum(datG[datch$Country=='New Zealand',2:11]>0),x=1,pch=16,col='red')
## Giardia
datG<- subset(datG, rowSums(datG[,2:9]) > 10)
datG.sc<-specaccum(datG[,2:9],'random')
plot(datG.sc,ci.type="poly", col="darkgreen", lwd=2, ci.lty=0, ci.col="lightgreen", main = expression(italic(Giardia)),
xlab='Countries',ylab='Assemblages',ylim=c(0,18),xlim=c(0,50))
points(x=1,y=6,cex=2,pch=16,col='red')
dev.off()
rm(list=ls())
require(doBy)
require(plyr)
require(rworldmap)
require(countrycode)
library(RColorBrewer)
data_giardia<-read.csv("giardia_world_nz_1.csv", header = T)
colnames(data_giardia)[1]<-'Country'
dF <- getMap()@data
iso<-countrycode(data_giardia$Country,"country.name","iso3c")
data_giardia$iso<-iso
malMap <- joinCountryData2Map(data_giardia, joinCode = "ISO3",
nameJoinColumn = "iso")
dF <- malMap@data
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
data_parvum<-read.csv("cparvum_world_nz_1.csv", header = T)
dF <- getMap()@data
iso<-countrycode(data_parvum$Country,"country.name","iso3c")
data_parvum$iso<-iso
malMap <- joinCountryData2Map(data_parvum, joinCode = "ISO3",
nameJoinColumn = "iso")
dF <- malMap@data
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
names(dF)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=brewer.pal(19,'Paired'),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
warnings()
library(RColorBrewer)
# Classic palette BuPu, with 4 colors
coul = brewer.pal(4, "BuPu")
# I can add more tones to this palette :
coul = colorRampPalette(coul)(25)
# Plot it
pie(rep(1, length(coul)), col = coul , main="")
library(RColorBrewer)
# Classic palette BuPu, with 4 colors
coul = brewer.pal(11, "Paired")
# I can add more tones to this palette :
coul = colorRampPalette(coul)(20)
# Plot it
pie(rep(1, length(coul)), col = coul , main="")
coul = brewer.pal(4, "Paired")
coul = colorRampPalette(coul)(19)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
warnings()
coul
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul(19),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul(1:19),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=colorRampPalette(coul)(19),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=colorRampPalette(coul)(19),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
coul
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
warnings()
coul = brewer.pal(4, "Paired")
coul = colorRampPalette(coul)(19)
length(coul)
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. parvum '),"genotypes")),
cex=3)
legend(-180.1516,90,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
legend(-180.1516,90,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul,#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
pie(rep(1, length(coul)), col = coul , main="")
coul = brewer.pal(10, "Paired")
coul = colorRampPalette(coul)(19)
pie(rep(1, length(coul)), col = coul , main="")
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
zColours=coul,#brewer.pal(12,'Paired'),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. parvum '),"genotypes")),
cex=3)
legend(-180.1516,90,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul,#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
legend(-180.1516,95,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi','IIj','IIk','IIl','IIm','IIn','IIo','IIp'),#
col=coul,#brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
source('~/GitHub/protozoa_map/haplotype_map_code.R', echo=TRUE)
source('~/GitHub/protozoa_map/psi_code.R', echo=TRUE)
