rm(list=ls())
require(doBy)
require(plyr)
require(rworldmap)
require(countrycode)
library(RColorBrewer)
data_giardia<-read.csv("giardia.csv", header = T)
data_giardia<-read.csv("Giardia_8-3-16.csv", header = T)
#require(TeachingDemos)
data_giardia<-read.csv("Giardia_11-3-16.csv", header = T)
dF <- getMap()@data
# data_giardia<-read.csv("giardia.csv", header = T)
iso<-countrycode(data_giardia$Country,"country.name","iso3c")
data_giardia$iso<-iso
#############
malMap <- joinCountryData2Map(data_giardia, joinCode = "ISO3",
nameJoinColumn = "iso")
# This will join your malDF data.frame to the country map data
# mapCountryData(malMap, nameColumnToPlot="A",
#                catMethod = "categorical",
#                mapTitle="",addLegend=F,
dF <- malMap@data
### make our pie plot
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c("A",
"B",
"C",
"D",
"E",
"F",
"G",
"H"),#,
zColours=brewer.pal(8,'Paired'),#c(1:8),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('Giardia '),"assemblages")),
cex=3)
legend(-180.1516,90,
legend=c("A",
"B",
"C",
"D",
"E",
"F",
"G",
"H"),
col=brewer.pal(8,'Paired'),#c(1:8),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
##
## to add NZ pie separately as needed
# library(mapplots)
head(dF)
plot(dF$LAT)
plot(dF$LAT,dF$A)
plot(dF$LAT,sum(dF$A,dF$B))
plot(dF$LAT,mean(dF$A,dF$B))
plot(dF$LAT,mean(dF$A,dF$B))
plot(dF$LAT,c(dF$A,dF$B))
plot(dF$LAT,rowsum(dF$A,dF$B))
plot(dF$LAT,rowSums(dF$A,dF$B))
plot(dF$LAT,rowSums(c(dF$A,dF$B)))
plot(dF$LAT,rowSums(dF$A,dF$B,na.rm = T))
head(dF)
data_giardia
malMap
test<-c(malMap$LAT)
test
class(malMap)
sp.na.omit <- function(x, margin=1) {
if (!inherits(x, "SpatialPointsDataFrame") & !inherits(x, "SpatialPolygonsDataFrame"))
stop("MUST BE sp SpatialPointsDataFrame OR SpatialPolygonsDataFrame CLASS OBJECT")
na.index <- unique(as.data.frame(which(is.na(x@data),arr.ind=TRUE))[,margin])
if(margin == 1) {
cat("DELETING ROWS: ", na.index, "\n")
return( x[-na.index,]  )
}
if(margin == 2) {
cat("DELETING COLUMNS: ", na.index, "\n")
return( x[,-na.index]  )
}
}
malMap2 <- sp.na.omit(malMap)
dim(malMap)
dim(malMap2)
head(malMap2)
malMap2 <- sp.na.omit(malMap[,malMap$A])
malMap2 <- sp.na.omit(malMap$A)
dim(malMap2)
malMap[!is.na(malMap["A"]),]
malMap2<-malMap[!is.na(malMap["A"]),]
malMap2<-malMap[!is.na(malMap["A"]),]
malMap2<-malMap[!is.na(malMap["A"]),]
plot(dF$LAT,dF$ADMIN)
plot(dF$LAT,dF$A)
plot(dF$LAT,(dF$A))
density(dF$LAT,(dF$A))
plot(density(dF$LAT,(dF$A)))
?density
plot(density(dF$LAT,(dF$A)))
density(dF$LAT,(dF$A))
density(dF$LAT)
plot(density(dF$LAT))
plot(density(dF$A))
data_giardia
plot(dF$LAT,(dF$A))
plot(dF$LAT,(dF$B),add=T)
plot(dF$LAT,(dF$A))
plot(dF$LAT,(dF$B))
plot(dF$LAT,(dF$C))
plot(dF$LAT,(dF$D))
plot(dF$LAT,(dF$E))
plot(dF$LAT,(dF$F))
plot(dF$LAT,(dF$G))
plot(dF$LAT,(dF$H))
class(dF)
class(dF$A)
plot(dF$LAT,(dF$H+dF$A))
plot(dF$LAT,(dF$H+dF$A+B))
plot(dF$LAT,(dF$H+dF$A+dF$B))
names(dF)
plot(dF$LAT,(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H))
plot(dF$LAT,density(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H))
plot(dF$LAT,(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H))
plot(abs(dF$LAT),(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H))
plot(abs(dF$LAT),(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H),xlim=c(0,90))
lm(abs(dF$LAT)~(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H))
density(abs(dF$LAT)~(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H))
?density
density((dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H))
density(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H)
plot(abs(dF$LAT),(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H),xlim=c(0,90),
ylab='Number',xlab='Absolute (Latitude)')
plot(abs(dF$LAT),(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H),xlim=c(0,90),
ylab='Number Giardia haplotypes',xlab='Absolute (Latitude)')
data_hominis<-read.csv("Hominis_8-3-16.csv", header = T)
data_hominis<-read.csv("Hominis_11-3-16.csv", header = T)
#require(TeachingDemos)
dF <- getMap()@data
iso<-countrycode(data_hominis$Country,"country.name","iso3c")
data_hominis$iso<-iso
#############
malMap <- joinCountryData2Map(data_hominis, joinCode = "ISO3",
nameJoinColumn = "iso")
dF <- malMap@data
### make our pie plot
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('Ia','Ib','Id','Ie', 'If', 'Ig' ,'Ii', 'Ij','Ik'),#
zColours=brewer.pal(9,'Paired'),#c(1:9),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. hominis '),"genotypes")),
cex=3)
legend(-180.1516,90,
legend=c('Ia','Ib','Id','Ie', 'If', 'Ig' ,'Ii', 'Ij','Ik'),
col=brewer.pal(9,'Paired'),#c(1:9),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
##
## to add NZ pie separately as needed
# library(mapplots)
# datNZ<-dF[which(dF$ADMIN=="New Zealand"),]
# vals<-c(datNZ$Ia,datNZ$Ib,datNZ$Id,datNZ$Ie,datNZ$If,datNZ$Ii,
#         datNZ$Ij,datNZ$Ik)
# add.pie(z=vals, x=170, y=-45, radius=12,
data_parvum<-read.csv("Parvum_8-3-16.csv", header = T)
data_parvum<-read.csv("Parvum_11-3-16.csv", header = T)
names(dF)
plot(abs(dF$LAT),(dF$Ia+dF$Ib+dF$Id+dF$Ie+dF$If+dF$Ig+dF$Ii+dF$Ij+dF$Ik),xlim=c(0,90),
ylab='Number C. hominis haplotypes',xlab='Absolute (Latitude)')
plot(abs(dF$LAT),(dF$Ia+dF$Ib+dF$Id+dF$Ie+dF$If+dF$Ig+dF$Ii+dF$Ij+dF$Ik),xlim=c(0,90),
ylab='Number C. hominis haplotypes',xlab='Absolute (Latitude)')
dev.off()
dev.off()
dev.off()
plot(abs(dF$LAT),(dF$Ia+dF$Ib+dF$Id+dF$Ie+dF$If+dF$Ig+dF$Ii+dF$Ij+dF$Ik),xlim=c(0,90),
ylab='Number C. hominis haplotypes',xlab='Absolute (Latitude)')
dF <- getMap()@data
iso<-countrycode(data_parvum$Country,"country.name","iso3c")
data_parvum$iso<-iso
#############
malMap <- joinCountryData2Map(data_parvum, joinCode = "ISO3",
nameJoinColumn = "iso")
# This will join your malDF data.frame to the country map data
# mapCountryData(malMap, nameColumnToPlot="Country",
#                catMethod = "categorical",
#                mapTitle="",addLegend=F,
#                missingCountryCol = "wheat",
#                mapRegion="world",
#                #                xlim=c(-15,10),
#                #                ylim=c(-5,25),
#                oceanCol = "lightblue",
#                colourPalette = "terrain"
# )
dF <- malMap@data
### make our pie plot
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi'),#
zColours=brewer.pal(12,'Paired'),#c(1:12),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. parvum '),"genotypes")),
cex=3)
legend(-180.1516,90,
legend=c('IIa'	,'IIc',	'IId',	'IIe'	,'IIj'	,'IIo',	'IIf'	,'IIl',	'IIb'	,'IIg',	'IIh',	'IIi'),
col=brewer.pal(12,'Paired'),#c(1:12),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
## to add New Zealand pie chart separately as needed
##
## library(mapplots)
# datNZ<-dF[which(dF$ADMIN=="New Zealand"),]
# vals<-c(datNZ$IIa,datNZ$IIc,datNZ$IId,datNZ$IIe,datNZ$IIj,datNZ$IIo,
#         datNZ$IIf,datNZ$IIl,datNZ$IIb,datNZ$IIg,datNZ$IIh,datNZ$IIi)
# add.pie(z=vals, x=170, y=-45, radius=12,
#         col=c(1:12), labels='')
names(dF)
plot(abs(dF$LAT),(dF$IIa+dF$IIc+dF$IId+dF$IIe+dF$IIj+dF$IIo+
dF$IIf+dF$IIl+dF$IIb+dF$IIg),xlim=c(0,90),
ylab='Number C. hominis haplotypes',xlab='Absolute (Latitude)')
plot(abs(dF$LAT),(dF$A+dF$B+dF$C+dF$D+dF$E+dF$F+dF$G+dF$H),xlim=c(0,90),
ylab='Number Giardia haplotypes',xlab='Absolute (Latitude)')
View(data_giardia)
malMap <- joinCountryData2Map(data_hominis, joinCode = "ISO3",
nameJoinColumn = "iso")
# This will join your malDF data.frame to the country map data
# mapCountryData(malMap, nameColumnToPlot="Country",
#                catMethod = "categorical",
#                mapTitle="",addLegend=F,
#                missingCountryCol = "wheat",
#                mapRegion="world",
#                #                xlim=c(-15,10),
#                #                ylim=c(-5,25),
#                oceanCol = "lightblue",
#                colourPalette = "terrain"
# )
dF <- malMap@data
### make our pie plot
par(mai= c(0,0,0.6,0),
xaxs = "i",
yaxs = "i")
mapPies(dF =dF,
nameX="LON",
nameY="LAT",
nameZs =c('Ia','Ib','Id','Ie', 'If', 'Ig' ,'Ii', 'Ij','Ik'),#
zColours=brewer.pal(9,'Paired'),#c(1:9),
symbolSize = 1.5,
oceanCol = "white",
landCol = "lightgrey",
addSizeLegend=F,
addCatLegend=F,
mapRegion="world",
#         xlim=c(-15,10),
#         ylim=c(-5,25)
add=F)
title(main=substitute(paste("Global distribution of ",italic('C. hominis '),"genotypes")),
cex=3)
legend(-180.1516,90,
legend=c('Ia','Ib','Id','Ie', 'If', 'Ig' ,'Ii', 'Ij','Ik'),
col=brewer.pal(9,'Paired'),#c(1:9),
pch=16,
cex=0.8,
pt.cex=1.5,
bty="o",
box.lty=0,
horiz = F,
bg="#FFFFFF70")
##
names(dF)
